---
output:
  md_document:
    variant: gfm

---
<p align="justify">    

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = TRUE, echo = FALSE}
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(dev = 'svg') # set output device to svg

```

In Experiment 1, we're looking at differences in the microbiome between coffee drinkers and non-coffee drinkers. 
```{r, warning=FALSE, message = FALSE}
source("scripts/ex1_baseline_differences_CD_vs_NCD.R")
```
```{r, warning=FALSE, message = FALSE, echo = FALSE}
source("subscripts/prep_cytokines.R")

```

```{r, warning=FALSE, message = FALSE, fig.width = 16, fig.height = 14}
(
  
  (ex1pca | (ex1alpha | (ex1DA/ex1DA_GBM + plot_layout(heights = c(3,1))))) 
  
  / 
  
  (
    (
      ex1_cyta  + ex1_cytb  + ex1_metab_forest_a  + ex1_metab_forest_b + plot_spacer()
     ) + plot_layout(widths = c(1,1,2,2,0.1))
    )
  ) + plot_layout(heights = c(2,3))

```

In Experiment 2, we're looking at features that return to non-coffee drinker levels post washout (coffee abstinence). 
```{r, warning=FALSE, message = FALSE}
source("scripts/ex_2_acute_and_full_withdrawal.R")
```

```{r, warning=FALSE, message = FALSE, fig.width = 16, fig.height = 16}
  ((ex_RESTpca + ex_RESTalpha + ex_RESTDA + plot_layout(widths = c(6,2,5))) / 
   ((ex2_cyta | ex2_cytb | ex_REST_metab_forest_a | ex_REST_metab_forest_b | plot_spacer()) + plot_layout(widths = c(1,1,2,2, 0.1))))  + plot_layout(heights = c(4,7))
```


In Experiment 3, we're looking at the effects of going back on either caffeinated or decaffeinated coffee post-washout (coffee abstinence). 

In this additional microbiome experiment 3B, we're looking at the acute effects of going back on either caffeinated or decaffeinated coffee post-washout (coffee abstinence). 
```{r, warning=FALSE, message = FALSE}
source("scripts/ex_3_intervention_acute_and_full_recaf_or_decaf.R")
```


```{r fig.height=16, fig.width=16, message=FALSE, warning=FALSE}
(
  (
    (ex_INTERVENTIONpca | ex_INTERVENTIONalpha) + 
     plot_layout(widths = c(2,1), guides = 'collect')
    ) 
  / 

    (
      (ex3_cyta  | ex3_cytb  | mb_b | (((mb_a |plot_spacer()) + plot_layout(widths = c(9,1))) / ex3metab) + plot_layout(heights = c(3,2))) + 
  
            plot_layout(guides = 'collect', widths = c(1,1,2,4))
      )
  ) + 

    plot_layout(heights = c(1,3))
```

Integrating 'omics and cognition

```{r, warning=FALSE, message = FALSE}
source("scripts/final_ex_integration.R")
```


```{r fig.height=16, fig.width=16, message=FALSE, warning=FALSE}
(f_1_2 | f_3tot) + plot_layout(guides = "collect", widths = c(1,4))
```